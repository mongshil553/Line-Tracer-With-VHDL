library ieee;
use ieee.std_logic_1164.all;

entity sensor_status_detector is
	port(	line_sensor : in std_logic_vector(7 downto 0);
			line_status : out std_logic_vector(2 downto 0);
			phase : in integer;
			info : out integer;
			
			full_line : in integer;
			soft_left : in integer;
			soft_right : in integer;
			strong_left : in integer;
			strong_right : in integer;
			middle : in integer
	);
end sensor_status_detector;

architecture design of sensor_status_detector is

begin
	
	process(phase, line_sensor)
	begin
		case phase is
			when 0 =>
				line_status <= "000";
			when 1 =>
				if soft_left >= 2 then
					line_status <= "100";
				elsif soft_right >= 2 then
					line_status <= "001";
				elsif strong_left >= 1 then
					line_status <= "110";
				elsif strong_right >= 1 then
					line_status <= "011";
				elsif middle = 2 then
					line_status <= "010";
				else
					null;
				end if;
			when 2 =>
				null;
			when 9 =>
				-- 7 6 5 4 3 2 1 0
				if full_line >= 6 then --full line
					line_status <= "111";
				elsif soft_left >= 2 then --soft left
					line_status <= "100";
				elsif soft_right >= 2 then --soft right
					line_status <= "001";
				elsif strong_left >= 1 then --strong left
					line_status <= "110";
				elsif strong_right >= 1 then --strong right
					line_status <= "011";
				elsif middle = 2 then --middle
					line_status <= "010";
				else
					null;
				end if;
			when others =>
				null;
		end case;
	end process;

end design;